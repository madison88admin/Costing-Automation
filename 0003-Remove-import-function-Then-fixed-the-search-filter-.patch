From 40448c81e3719bf12865696e4f960a45e6a5763c Mon Sep 17 00:00:00 2001
From: wardKawaii <mendz0908@gmail.com>
Date: Thu, 18 Sep 2025 08:52:25 +0800
Subject: [PATCH 03/22] Remove import function, Then fixed the search filter
 function.

---
 dist/routes/import.d.ts.map            |   2 +-
 dist/routes/import.js                  |  33 +-
 dist/routes/import.js.map              |   2 +-
 dist/services/importService.d.ts       |   2 -
 dist/services/importService.d.ts.map   |   2 +-
 dist/services/importService.js         |  61 --
 dist/services/importService.js.map     |   2 +-
 dist/services/supabaseService.d.ts.map |   2 +-
 dist/services/supabaseService.js       |  52 +-
 dist/services/supabaseService.js.map   |   2 +-
 index.html                             |   5 +-
 logs/combined.log                      |   1 +
 package.json                           |   4 +-
 public/index.html                      | 879 +------------------------
 src/routes/import.ts                   |  36 +-
 src/services/importService.ts          |  28 -
 16 files changed, 76 insertions(+), 1037 deletions(-)

diff --git a/dist/routes/import.d.ts.map b/dist/routes/import.d.ts.map
index 1f55346..369a3c2 100644
--- a/dist/routes/import.d.ts.map
+++ b/dist/routes/import.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"import.d.ts","sourceRoot":"","sources":["../../src/routes/import.ts"],"names":[],"mappings":"AAQA,QAAA,MAAM,MAAM,4CAAW,CAAC;AA+JxB,eAAe,MAAM,CAAC"}
\ No newline at end of file
+{"version":3,"file":"import.d.ts","sourceRoot":"","sources":["../../src/routes/import.ts"],"names":[],"mappings":"AAQA,QAAA,MAAM,MAAM,4CAAW,CAAC;AAiIxB,eAAe,MAAM,CAAC"}
\ No newline at end of file
diff --git a/dist/routes/import.js b/dist/routes/import.js
index db446f9..7ed9f3c 100644
--- a/dist/routes/import.js
+++ b/dist/routes/import.js
@@ -17,17 +17,14 @@ const upload = (0, multer_1.default)({
     },
     fileFilter: (req, file, cb) => {
         const allowedTypes = [
-            'text/csv',
-            'application/vnd.ms-excel',
-            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
+            'text/csv'
         ];
         if (allowedTypes.includes(file.mimetype) ||
-            file.originalname.endsWith('.csv') ||
-            file.originalname.endsWith('.xlsx')) {
+            file.originalname.endsWith('.csv')) {
             cb(null, true);
         }
         else {
-            cb(new Error('Invalid file type. Only CSV and Excel files are allowed.'));
+            cb(new Error('Invalid file type. Only CSV files are allowed.'));
         }
     }
 });
@@ -78,30 +75,6 @@ router.post('/csv/:connectionId', upload.single('file'), async (req, res) => {
         });
     }
 });
-router.post('/excel/:connectionId', upload.single('file'), async (req, res) => {
-    try {
-        const { connectionId } = req.params;
-        const config = JSON.parse(req.body.config);
-        const { sheetName } = req.body;
-        if (!req.file) {
-            return res.status(400).json({ error: 'No file uploaded' });
-        }
-        const connection = (0, connections_1.getConnection)(connectionId);
-        if (!connection) {
-            return res.status(404).json({ error: 'Connection not found' });
-        }
-        const importService = new importService_1.ImportService(connection);
-        const result = await importService.importExcel(req.file, config, sheetName);
-        return res.json(result);
-    }
-    catch (error) {
-        logger_1.default.error('Error importing Excel:', error);
-        return res.status(500).json({
-            error: 'Failed to import Excel',
-            message: error instanceof Error ? error.message : 'Unknown error'
-        });
-    }
-});
 router.post('/bulk-insert/:connectionId', async (req, res) => {
     try {
         const { connectionId } = req.params;
diff --git a/dist/routes/import.js.map b/dist/routes/import.js.map
index 6926485..099c197 100644
--- a/dist/routes/import.js.map
+++ b/dist/routes/import.js.map
@@ -1 +1 @@
-{"version":3,"file":"import.js","sourceRoot":"","sources":["../../src/routes/import.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"import.js","sourceRoot":"","sources":["../../src/routes/import.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/services/importService.d.ts b/dist/services/importService.d.ts
index e7b9e15..0f7d582 100644
--- a/dist/services/importService.d.ts
+++ b/dist/services/importService.d.ts
@@ -4,9 +4,7 @@ export declare class ImportService {
     private db;
     constructor(database: DatabaseConnection);
     importCSV(file: FileUpload, config: ImportConfig): Promise<ImportResult>;
-    importExcel(file: FileUpload, config: ImportConfig, sheetName?: string): Promise<ImportResult>;
     private parseCSV;
-    private parseExcel;
     private processData;
     private validateMappings;
     private processBatch;
diff --git a/dist/services/importService.d.ts.map b/dist/services/importService.d.ts.map
index bd934f6..b89bff5 100644
--- a/dist/services/importService.d.ts.map
+++ b/dist/services/importService.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"importService.d.ts","sourceRoot":"","sources":["../../src/services/importService.ts"],"names":[],"mappings":"AAGA,OAAO,EAAE,kBAAkB,EAAE,MAAM,oBAAoB,CAAC;AACxD,OAAO,EAAE,YAAY,EAAE,UAAU,EAAE,YAAY,EAAiB,MAAM,UAAU,CAAC;AAGjF,qBAAa,aAAa;IACxB,OAAO,CAAC,EAAE,CAAqB;gBAEnB,QAAQ,EAAE,kBAAkB;IAIlC,SAAS,CAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC;IAgBxE,WAAW,CAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,YAAY,EAAE,SAAS,CAAC,EAAE,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC;YAgBtF,QAAQ;YAaR,UAAU;YAWV,WAAW;IAuCzB,OAAO,CAAC,gBAAgB;YAeV,YAAY;IA4B1B,OAAO,CAAC,UAAU;IAiBlB,OAAO,CAAC,eAAe;IAsBjB,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC;YAa7D,YAAY;IAqB1B,OAAO,CAAC,UAAU;IAQZ,cAAc,CAAC,IAAI,EAAE,UAAU,EAAE,OAAO,GAAE,MAAW,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC;CAkB7E"}
\ No newline at end of file
+{"version":3,"file":"importService.d.ts","sourceRoot":"","sources":["../../src/services/importService.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,kBAAkB,EAAE,MAAM,oBAAoB,CAAC;AACxD,OAAO,EAAE,YAAY,EAAE,UAAU,EAAE,YAAY,EAAiB,MAAM,UAAU,CAAC;AAGjF,qBAAa,aAAa;IACxB,OAAO,CAAC,EAAE,CAAqB;gBAEnB,QAAQ,EAAE,kBAAkB;IAIlC,SAAS,CAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC;YAiBhE,QAAQ;YAcR,WAAW;IAuCzB,OAAO,CAAC,gBAAgB;YAeV,YAAY;IA4B1B,OAAO,CAAC,UAAU;IAiBlB,OAAO,CAAC,eAAe;IAsBjB,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC;YAa7D,YAAY;IAqB1B,OAAO,CAAC,UAAU;IAQZ,cAAc,CAAC,IAAI,EAAE,UAAU,EAAE,OAAO,GAAE,MAAW,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC;CAgB7E"}
\ No newline at end of file
diff --git a/dist/services/importService.js b/dist/services/importService.js
index 0710d6d..4bbadba 100644
--- a/dist/services/importService.js
+++ b/dist/services/importService.js
@@ -1,43 +1,9 @@
 "use strict";
-var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
-    if (k2 === undefined) k2 = k;
-    var desc = Object.getOwnPropertyDescriptor(m, k);
-    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
-      desc = { enumerable: true, get: function() { return m[k]; } };
-    }
-    Object.defineProperty(o, k2, desc);
-}) : (function(o, m, k, k2) {
-    if (k2 === undefined) k2 = k;
-    o[k2] = m[k];
-}));
-var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
-    Object.defineProperty(o, "default", { enumerable: true, value: v });
-}) : function(o, v) {
-    o["default"] = v;
-});
-var __importStar = (this && this.__importStar) || (function () {
-    var ownKeys = function(o) {
-        ownKeys = Object.getOwnPropertyNames || function (o) {
-            var ar = [];
-            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
-            return ar;
-        };
-        return ownKeys(o);
-    };
-    return function (mod) {
-        if (mod && mod.__esModule) return mod;
-        var result = {};
-        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
-        __setModuleDefault(result, mod);
-        return result;
-    };
-})();
 var __importDefault = (this && this.__importDefault) || function (mod) {
     return (mod && mod.__esModule) ? mod : { "default": mod };
 };
 Object.defineProperty(exports, "__esModule", { value: true });
 exports.ImportService = void 0;
-const XLSX = __importStar(require("xlsx"));
 const csv_parser_1 = __importDefault(require("csv-parser"));
 const stream_1 = require("stream");
 const logger_1 = __importDefault(require("../utils/logger"));
@@ -61,22 +27,6 @@ class ImportService {
             };
         }
     }
-    async importExcel(file, config, sheetName) {
-        try {
-            const data = await this.parseExcel(file.buffer, sheetName);
-            return await this.processData(data, config);
-        }
-        catch (error) {
-            logger_1.default.error('Excel import error:', error);
-            return {
-                success: false,
-                message: `Excel import failed: ${error}`,
-                rowsProcessed: 0,
-                rowsInserted: 0,
-                errors: [error instanceof Error ? error.message : String(error)]
-            };
-        }
-    }
     async parseCSV(buffer) {
         return new Promise((resolve, reject) => {
             const results = [];
@@ -88,14 +38,6 @@ class ImportService {
                 .on('error', reject);
         });
     }
-    async parseExcel(buffer, sheetName) {
-        const workbook = XLSX.read(buffer, { type: 'buffer' });
-        const sheet = sheetName ? workbook.Sheets[sheetName] : workbook.Sheets[workbook.SheetNames[0]];
-        if (!sheet) {
-            throw new Error(`Sheet "${sheetName || workbook.SheetNames[0]}" not found`);
-        }
-        return XLSX.utils.sheet_to_json(sheet);
-    }
     async processData(data, config) {
         const errors = [];
         let rowsProcessed = 0;
@@ -238,9 +180,6 @@ class ImportService {
             if (file.mimetype === 'text/csv' || file.originalname.endsWith('.csv')) {
                 data = await this.parseCSV(file.buffer);
             }
-            else if (file.mimetype.includes('spreadsheet') || file.originalname.endsWith('.xlsx')) {
-                data = await this.parseExcel(file.buffer);
-            }
             else {
                 throw new Error('Unsupported file type');
             }
diff --git a/dist/services/importService.js.map b/dist/services/importService.js.map
index 6298914..c1c680a 100644
--- a/dist/services/importService.js.map
+++ b/dist/services/importService.js.map
@@ -1 +1 @@
-{"version":3,"file":"importService.js","sourceRoot":"","sources":["../../src/services/importService.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"importService.js","sourceRoot":"","sources":["../../src/services/importService.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/services/supabaseService.d.ts.map b/dist/services/supabaseService.d.ts.map
index a1e6cc5..3f8c2d1 100644
--- a/dist/services/supabaseService.d.ts.map
+++ b/dist/services/supabaseService.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"supabaseService.d.ts","sourceRoot":"","sources":["../../src/services/supabaseService.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,cAAc,EAAE,iBAAiB,EAAE,SAAS,EAAE,MAAM,UAAU,CAAC;AAGxE,qBAAa,eAAe;IAC1B,OAAO,CAAC,QAAQ,CAAiB;gBAErB,WAAW,EAAE,MAAM,EAAE,WAAW,EAAE,MAAM;IAI9C,SAAS,IAAI,OAAO,CAAC,MAAM,EAAE,CAAC;IAuC9B,YAAY,CAAC,SAAS,EAAE,MAAM,GAAG,OAAO,CAAC,SAAS,CAAC;IA0CzD,OAAO,CAAC,SAAS;IAeX,YAAY,CAAC,KAAK,EAAE,cAAc,GAAG,OAAO,CAAC,iBAAiB,CAAC;IA+F/D,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;IAgBpE,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,GAAG,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;IAiBzF,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,GAAG,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC;IAelE,UAAU,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC;IAetE,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;CAe3E"}
\ No newline at end of file
+{"version":3,"file":"supabaseService.d.ts","sourceRoot":"","sources":["../../src/services/supabaseService.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,cAAc,EAAE,iBAAiB,EAAE,SAAS,EAAE,MAAM,UAAU,CAAC;AAGxE,qBAAa,eAAe;IAC1B,OAAO,CAAC,QAAQ,CAAiB;gBAErB,WAAW,EAAE,MAAM,EAAE,WAAW,EAAE,MAAM;IAI9C,SAAS,IAAI,OAAO,CAAC,MAAM,EAAE,CAAC;IAuC9B,YAAY,CAAC,SAAS,EAAE,MAAM,GAAG,OAAO,CAAC,SAAS,CAAC;IA0CzD,OAAO,CAAC,SAAS;IAeX,YAAY,CAAC,KAAK,EAAE,cAAc,GAAG,OAAO,CAAC,iBAAiB,CAAC;IA4G/D,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;IAgBpE,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,GAAG,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;IAiBzF,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,GAAG,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC;IAelE,UAAU,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC;IAetE,YAAY,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;CAe3E"}
\ No newline at end of file
diff --git a/dist/services/supabaseService.js b/dist/services/supabaseService.js
index 5600731..c63204b 100644
--- a/dist/services/supabaseService.js
+++ b/dist/services/supabaseService.js
@@ -117,30 +117,42 @@ class SupabaseService {
             }
             let data, error, count;
             if (isLargeDataset) {
-                const allData = [];
-                let offset = 0;
-                const batchSize = 1000;
-                let hasMoreData = true;
-                while (hasMoreData) {
-                    const batchQuery = queryBuilder.range(offset, offset + batchSize - 1);
-                    const { data: batchData, error: batchError } = await batchQuery;
-                    if (batchError) {
-                        error = batchError;
-                        break;
-                    }
-                    if (batchData && batchData.length > 0) {
-                        allData.push(...batchData);
-                        offset += batchSize;
-                        if (batchData.length < batchSize) {
+                const countQuery = this.supabase.from(table).select('*', { count: 'exact', head: true });
+                const { count: totalCount, error: countError } = await countQuery;
+                if (countError) {
+                    error = countError;
+                    logger_1.default.error('Error getting total count:', countError);
+                }
+                else {
+                    logger_1.default.info(`Total records in database: ${totalCount}`);
+                    const allData = [];
+                    let offset = 0;
+                    const batchSize = 1000;
+                    let hasMoreData = true;
+                    while (hasMoreData) {
+                        const batchQuery = queryBuilder.range(offset, offset + batchSize - 1);
+                        const { data: batchData, error: batchError } = await batchQuery;
+                        if (batchError) {
+                            error = batchError;
+                            logger_1.default.error('Error fetching batch:', batchError);
+                            break;
+                        }
+                        if (batchData && batchData.length > 0) {
+                            allData.push(...batchData);
+                            offset += batchSize;
+                            logger_1.default.info(`Fetched batch: ${batchData.length} records (total so far: ${allData.length})`);
+                            if (batchData.length < batchSize) {
+                                hasMoreData = false;
+                            }
+                        }
+                        else {
                             hasMoreData = false;
                         }
                     }
-                    else {
-                        hasMoreData = false;
-                    }
+                    data = allData;
+                    count = totalCount;
+                    logger_1.default.info(`Final result: ${allData.length} records loaded, total count: ${totalCount}`);
                 }
-                data = allData;
-                count = allData.length;
             }
             else {
                 const offset = (page - 1) * limit;
diff --git a/dist/services/supabaseService.js.map b/dist/services/supabaseService.js.map
index 88f6aaf..07b2074 100644
--- a/dist/services/supabaseService.js.map
+++ b/dist/services/supabaseService.js.map
@@ -1 +1 @@
-{"version":3,"file":"supabaseService.js","sourceRoot":"","sources":["../../src/services/supabaseService.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"supabaseService.js","sourceRoot":"","sources":["../../src/services/supabaseService.ts"],"names":[],"mappings":";;;;;;AAAA,uDAAqE;AAErE,6DAAqC;AAErC,MAAa,eAAe;IAG1B,YAAY,WAAmB,EAAE,WAAmB;QAClD,IAAI,CAAC,QAAQ,GAAG,IAAA,0BAAY,EAAC,WAAW,EAAE,WAAW,CAAC,CAAC;IACzD,CAAC;IAED,KAAK,CAAC,SAAS;QACb,IAAI,CAAC;YAOH,MAAM,YAAY,GAAG,CAAC,UAAU,EAAE,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,WAAW,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;YAC/G,MAAM,cAAc,GAAa,EAAE,CAAC;YAEpC,KAAK,MAAM,SAAS,IAAI,YAAY,EAAE,CAAC;gBACrC,IAAI,CAAC;oBACH,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;yBAClC,IAAI,CAAC,SAAS,CAAC;yBACf,MAAM,CAAC,GAAG,CAAC;yBACX,KAAK,CAAC,CAAC,CAAC,CAAC;oBAEZ,IAAI,CAAC,KAAK,EAAE,CAAC;wBACX,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBACjC,CAAC;gBACH,CAAC;gBAAC,OAAO,CAAC,EAAE,CAAC;gBAEb,CAAC;YACH,CAAC;YAGD,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBAChC,gBAAM,CAAC,IAAI,CAAC,kFAAkF,CAAC,CAAC;gBAChG,OAAO,CAAC,uDAAuD,CAAC,CAAC;YACnE,CAAC;YAED,OAAO,cAAc,CAAC;QACxB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAC;YAC7C,MAAM,IAAI,KAAK,CAAC,2FAA2F,CAAC,CAAC;QAC/G,CAAC;IACH,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,SAAiB;QAClC,IAAI,CAAC;YAIH,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBAC/D,IAAI,CAAC,SAAS,CAAC;iBACf,MAAM,CAAC,GAAG,CAAC;iBACX,KAAK,CAAC,CAAC,CAAC,CAAC;YAEZ,IAAI,SAAS;gBAAE,MAAM,SAAS,CAAC;YAG/B,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBACrD,IAAI,CAAC,SAAS,CAAC;iBACf,MAAM,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;YAE/C,IAAI,UAAU;gBAAE,MAAM,UAAU,CAAC;YAGjC,MAAM,OAAO,GAAG,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC;gBACjD,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;oBACrC,IAAI,EAAE,GAAG;oBACT,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;oBACxC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,IAAI;oBACrC,UAAU,EAAE,GAAG,KAAK,IAAI;oBACxB,aAAa,EAAE,GAAG,KAAK,IAAI;oBAC3B,YAAY,EAAE,IAAI;iBACnB,CAAC,CAAC;gBACL,CAAC,CAAC,EAAE,CAAC;YAEP,OAAO;gBACL,IAAI,EAAE,SAAS;gBACf,OAAO;gBACP,QAAQ,EAAE,KAAK,IAAI,CAAC;aACrB,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;YACjD,MAAM,IAAI,KAAK,CAAC,qCAAqC,SAAS,qDAAqD,CAAC,CAAC;QACvH,CAAC;IACH,CAAC;IAEO,SAAS,CAAC,KAAU;QAC1B,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS;YAAE,OAAO,SAAS,CAAC;QAC5D,IAAI,OAAO,KAAK,KAAK,SAAS;YAAE,OAAO,SAAS,CAAC;QACjD,IAAI,OAAO,KAAK,KAAK,QAAQ;YAAE,OAAO,SAAS,CAAC;QAChD,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;YAE9B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;gBAAE,OAAO,WAAW,CAAC;YACzE,OAAO,MAAM,CAAC;QAChB,CAAC;QACD,IAAI,KAAK,YAAY,IAAI;YAAE,OAAO,WAAW,CAAC;QAC9C,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;YAAE,OAAO,OAAO,CAAC;QACzC,IAAI,OAAO,KAAK,KAAK,QAAQ;YAAE,OAAO,OAAO,CAAC;QAC9C,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,KAAqB;QACtC,IAAI,CAAC;YACH,MAAM,EAAE,KAAK,EAAE,IAAI,GAAG,CAAC,EAAE,KAAK,GAAG,EAAE,EAAE,MAAM,EAAE,SAAS,GAAG,KAAK,EAAE,OAAO,GAAG,EAAE,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;YAI/F,MAAM,cAAc,GAAG,KAAK,GAAG,IAAI,CAAC;YAEpC,IAAI,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;YAG7E,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAAE;gBAC/C,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,EAAE,EAAE,CAAC;oBAC1D,YAAY,GAAG,YAAY,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;gBAC7C,CAAC;YACH,CAAC,CAAC,CAAC;YAGH,IAAI,MAAM,EAAE,CAAC;gBAEX,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;gBACjD,MAAM,iBAAiB,GAAG,SAAS,CAAC,OAAO;qBACxC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;qBAC1E,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAExB,IAAI,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBACjC,MAAM,gBAAgB,GAAG,iBAAiB,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,WAAW,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBAC5F,YAAY,GAAG,YAAY,CAAC,EAAE,CAAC,gBAAgB,CAAC,CAAC;gBACnD,CAAC;YACH,CAAC;YAGD,IAAI,MAAM,EAAE,CAAC;gBACX,YAAY,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,SAAS,KAAK,KAAK,EAAE,CAAC,CAAC;YAChF,CAAC;YAED,IAAI,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC;YAEvB,IAAI,cAAc,EAAE,CAAC;gBAGnB,MAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;gBACzF,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,MAAM,UAAU,CAAC;gBAElE,IAAI,UAAU,EAAE,CAAC;oBACf,KAAK,GAAG,UAAU,CAAC;oBACnB,gBAAM,CAAC,KAAK,CAAC,4BAA4B,EAAE,UAAU,CAAC,CAAC;gBACzD,CAAC;qBAAM,CAAC;oBACN,gBAAM,CAAC,IAAI,CAAC,8BAA8B,UAAU,EAAE,CAAC,CAAC;oBAExD,MAAM,OAAO,GAAG,EAAE,CAAC;oBACnB,IAAI,MAAM,GAAG,CAAC,CAAC;oBACf,MAAM,SAAS,GAAG,IAAI,CAAC;oBACvB,IAAI,WAAW,GAAG,IAAI,CAAC;oBAEvB,OAAO,WAAW,EAAE,CAAC;wBACnB,MAAM,UAAU,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,MAAM,GAAG,SAAS,GAAG,CAAC,CAAC,CAAC;wBACtE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,MAAM,UAAU,CAAC;wBAEhE,IAAI,UAAU,EAAE,CAAC;4BACf,KAAK,GAAG,UAAU,CAAC;4BACnB,gBAAM,CAAC,KAAK,CAAC,uBAAuB,EAAE,UAAU,CAAC,CAAC;4BAClD,MAAM;wBACR,CAAC;wBAED,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;4BACtC,OAAO,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC,CAAC;4BAC3B,MAAM,IAAI,SAAS,CAAC;4BACpB,gBAAM,CAAC,IAAI,CAAC,kBAAkB,SAAS,CAAC,MAAM,2BAA2B,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;4BAG5F,IAAI,SAAS,CAAC,MAAM,GAAG,SAAS,EAAE,CAAC;gCACjC,WAAW,GAAG,KAAK,CAAC;4BACtB,CAAC;wBACH,CAAC;6BAAM,CAAC;4BACN,WAAW,GAAG,KAAK,CAAC;wBACtB,CAAC;oBACH,CAAC;oBAED,IAAI,GAAG,OAAO,CAAC;oBACf,KAAK,GAAG,UAAU,CAAC;oBACnB,gBAAM,CAAC,IAAI,CAAC,iBAAiB,OAAO,CAAC,MAAM,iCAAiC,UAAU,EAAE,CAAC,CAAC;gBAC5F,CAAC;YACH,CAAC;iBAAM,CAAC;gBAEN,MAAM,MAAM,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;gBAClC,YAAY,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,MAAM,GAAG,KAAK,GAAG,CAAC,CAAC,CAAC;gBAC9D,MAAM,MAAM,GAAG,MAAM,YAAY,CAAC;gBAClC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;gBACnB,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;gBACrB,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;YACvB,CAAC;YAED,IAAI,KAAK;gBAAE,MAAM,KAAK,CAAC;YAEvB,OAAO;gBACL,IAAI,EAAE,IAAI,IAAI,EAAE;gBAChB,KAAK,EAAE,KAAK,IAAI,CAAC;gBACjB,IAAI;gBACJ,KAAK;gBACL,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC;aAC5C,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;YACjD,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;QACnD,CAAC;IACH,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,KAAa,EAAE,IAAyB;QACzD,IAAI,CAAC;YACH,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBAChD,IAAI,CAAC,KAAK,CAAC;iBACX,MAAM,CAAC,IAAI,CAAC;iBACZ,MAAM,EAAE;iBACR,MAAM,EAAE,CAAC;YAEZ,IAAI,KAAK;gBAAE,MAAM,KAAK,CAAC;YACvB,OAAO,MAAM,CAAC;QAChB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAC/C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC7C,CAAC;IACH,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,KAAa,EAAE,EAAmB,EAAE,IAAyB;QAC9E,IAAI,CAAC;YACH,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBAChD,IAAI,CAAC,KAAK,CAAC;iBACX,MAAM,CAAC,IAAI,CAAC;iBACZ,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC;iBACZ,MAAM,EAAE;iBACR,MAAM,EAAE,CAAC;YAEZ,IAAI,KAAK;gBAAE,MAAM,KAAK,CAAC;YACvB,OAAO,MAAM,CAAC;QAChB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;YAC9C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC7C,CAAC;IACH,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,KAAa,EAAE,EAAmB;QACnD,IAAI,CAAC;YACH,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBAClC,IAAI,CAAC,KAAK,CAAC;iBACX,MAAM,EAAE;iBACR,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAEhB,IAAI,KAAK;gBAAE,MAAM,KAAK,CAAC;YACvB,OAAO,IAAI,CAAC;QACd,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;YAC9C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC7C,CAAC;IACH,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,KAAa,EAAE,IAA2B;QACzD,IAAI,CAAC;YACH,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBAChD,IAAI,CAAC,KAAK,CAAC;iBACX,MAAM,CAAC,IAAI,CAAC;iBACZ,MAAM,EAAE,CAAC;YAEZ,IAAI,KAAK;gBAAE,MAAM,KAAK,CAAC;YACvB,OAAO,MAAM,IAAI,EAAE,CAAC;QACtB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,+BAA+B,EAAE,KAAK,CAAC,CAAC;YACrD,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;QACnD,CAAC;IACH,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,KAAa,EAAE,IAAyB;QACzD,IAAI,CAAC;YACH,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,CAAC,QAAQ;iBAChD,IAAI,CAAC,KAAK,CAAC;iBACX,MAAM,CAAC,IAAI,CAAC;iBACZ,MAAM,EAAE;iBACR,MAAM,EAAE,CAAC;YAEZ,IAAI,KAAK;gBAAE,MAAM,KAAK,CAAC;YACvB,OAAO,MAAM,CAAC;QAChB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,gBAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAC/C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC7C,CAAC;IACH,CAAC;CACF;AAjSD,0CAiSC"}
\ No newline at end of file
diff --git a/index.html b/index.html
index 146abde..1edf83a 100644
--- a/index.html
+++ b/index.html
@@ -2346,10 +2346,7 @@
             formData.append('config', JSON.stringify(config));
 
             try {
-                const isCSV = currentFile.name.endsWith('.csv');
-                const endpoint = isCSV ? 'csv' : 'excel';
-                
-                const response = await fetch(`/api/import/${endpoint}/${connectionId}`, {
+                const response = await fetch(`/api/import/csv/${connectionId}`, {
                     method: 'POST',
                     body: formData
                 });
diff --git a/logs/combined.log b/logs/combined.log
index 396b8f9..22eb056 100644
--- a/logs/combined.log
+++ b/logs/combined.log
@@ -77,3 +77,4 @@
 {"level":"info","message":"Fetched batch: 1000 records (total so far: 2000)","service":"costing-automation","timestamp":"2025-09-16T06:17:06.723Z"}
 {"level":"info","message":"Fetched batch: 773 records (total so far: 2773)","service":"costing-automation","timestamp":"2025-09-16T06:17:06.958Z"}
 {"level":"info","message":"Final result: 2773 records loaded, total count: 2773","service":"costing-automation","timestamp":"2025-09-16T06:17:06.959Z"}
+{"level":"info","message":"Server running on port 3000","service":"costing-automation","timestamp":"2025-09-18T00:11:08.512Z"}
diff --git a/package.json b/package.json
index 67dc4ec..d34bfb0 100644
--- a/package.json
+++ b/package.json
@@ -12,7 +12,6 @@
   "keywords": [
     "database",
     "csv",
-    "excel",
     "data-management",
     "automation"
   ],
@@ -34,8 +33,7 @@
     "mysql2": "^3.6.5",
     "pg": "^8.11.3",
     "sqlite3": "^5.1.6",
-    "winston": "^3.11.0",
-    "xlsx": "^0.18.5"
+    "winston": "^3.11.0"
   },
   "devDependencies": {
     "@types/bcryptjs": "^2.4.6",
diff --git a/public/index.html b/public/index.html
index 4b242fe..7531db9 100644
--- a/public/index.html
+++ b/public/index.html
@@ -339,32 +339,6 @@
             color: #2c2c2c;
         }
 
-        .import-button {
-            background: #3b82f6;
-            color: white;
-            border: 2px solid #3b82f6;
-            padding: 16px 25px;
-            border-radius: 12px;
-            font-size: 16px;
-            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
-            font-weight: 500;
-            cursor: pointer;
-            transition: all 0.3s ease;
-            min-width: 100px;
-            letter-spacing: 0.5px;
-            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
-        }
-
-        .import-button:hover {
-            background: #2563eb;
-            border-color: #2563eb;
-            transform: translateY(-1px);
-            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
-        }
-
-        .import-button:active {
-            transform: translateY(0);
-        }
 
         /* Responsive Design */
         @media (max-width: 768px) {
@@ -646,40 +620,6 @@
             background: rgba(255, 255, 255, 0.05);
         }
 
-        .import-header {
-            display: flex;
-            align-items: center;
-            margin-bottom: 25px;
-        }
-
-        .import-icon {
-            width: 48px;
-            height: 48px;
-            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-            border-radius: 12px;
-            display: flex;
-            align-items: center;
-            justify-content: center;
-            margin-right: 15px;
-            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
-        }
-
-        .import-title {
-            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
-            font-size: 24px;
-            font-weight: 600;
-            color: #ffffff;
-            margin: 0;
-            letter-spacing: 0.5px;
-            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
-        }
-
-        .import-subtitle {
-            color: #ffffff;
-            font-size: 16px;
-            margin: 8px 0 0 0;
-            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
-        }
 
         .form-row {
             display: grid;
@@ -717,82 +657,7 @@
             box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
         }
 
-        .file-upload {
-            border: 3px dashed #667eea;
-            padding: 40px 20px;
-            text-align: center;
-            border-radius: 12px;
-            cursor: pointer;
-            background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
-            transition: all 0.3s ease;
-            position: relative;
-            overflow: hidden;
-        }
-
-        .file-upload::before {
-            content: '';
-            position: absolute;
-            top: 0;
-            left: -100%;
-            width: 100%;
-            height: 100%;
-            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
-            transition: left 0.5s ease;
-        }
-
-        .file-upload:hover {
-            border-color: #764ba2;
-            background: linear-gradient(135deg, #f0f2ff 0%, #ffffff 100%);
-            transform: translateY(-2px);
-            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
-        }
-
-        .file-upload:hover::before {
-            left: 100%;
-        }
-
-        .file-upload-content {
-            position: relative;
-            z-index: 1;
-        }
-
-        .file-upload-icon {
-            font-size: 48px;
-            color: #667eea;
-            margin-bottom: 15px;
-            display: block;
-        }
-
-        .file-upload-text {
-            font-size: 18px;
-            font-weight: 600;
-            color: #495057;
-            margin-bottom: 8px;
-        }
-
-        .file-upload-subtext {
-            font-size: 14px;
-            color: #6c757d;
-            margin: 0;
-        }
-
-        .supported-formats {
-            display: flex;
-            justify-content: center;
-            gap: 15px;
-            margin-top: 15px;
-        }
 
-        .format-badge {
-            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-            color: white;
-            padding: 6px 12px;
-            border-radius: 20px;
-            font-size: 12px;
-            font-weight: 600;
-            text-transform: uppercase;
-            letter-spacing: 0.5px;
-        }
 
         .hidden {
             display: none;
@@ -1070,9 +935,6 @@
                     <button class="import-button" onclick="exportToExcel()">
                         Export
                     </button>
-                    <button class="import-button" onclick="openImportModal()" style="background: #6f42c1;">
-                        Import
-                    </button>
                 </div>
             </div>
             
@@ -1102,179 +964,8 @@
             </div>
         </div>
 
-        <!-- Import Modal -->
-        <div class="modal-overlay" id="importModal">
-            <div class="modal-content">
-                <button class="modal-close" onclick="closeImportModal()">&times;</button>
-                
-                <div class="import-header">
-                    <div class="import-icon">
-                        🤖
-                    </div>
-                    <div>
-                        <h2 class="import-title">Intelligent Import System</h2>
-                        <p class="import-subtitle">AI-powered data extraction and validation</p>
-                    </div>
-            </div>
-            
-            <div class="file-upload" onclick="document.getElementById('fileInput').click()">
-                    <div class="file-upload-content">
-                        <div class="file-upload-icon">📁</div>
-                        <div class="file-upload-text">Click to select your file</div>
-                        <div class="file-upload-subtext">Drag and drop or click to browse</div>
-                        <div class="supported-formats">
-                            <span class="format-badge">CSV</span>
-                            <span class="format-badge">XLSX</span>
-                            <span class="format-badge">XLS</span>
-                            <span class="format-badge">XLSM</span>
-                        </div>
-                    </div>
-                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls,.xlsm" style="display: none;" onchange="handleFileSelect(event)">
-            </div>
-            
-            <!-- Template Detection Info -->
-            <div class="template-info" style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 20px; margin: 20px 0; border: 1px solid rgba(255, 255, 255, 0.2);">
-                <h4 style="color: white; margin-bottom: 15px;">🎯 Supported Templates</h4>
-                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
-                    <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 8px;">
-                        <h5 style="color: #4CAF50; margin-bottom: 10px;">✅ Beanie Template</h5>
-                        <ul style="color: rgba(255, 255, 255, 0.9); font-size: 14px; margin: 0; padding-left: 20px;">
-                            <li>YARN section</li>
-                            <li>FABRIC section</li>
-                            <li>TRIM section</li>
-                        </ul>
-                    </div>
-                    <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 8px;">
-                        <h5 style="color: #2196F3; margin-bottom: 10px;">✅ Cap Template</h5>
-                        <ul style="color: rgba(255, 255, 255, 0.9); font-size: 14px; margin: 0; padding-left: 20px;">
-                            <li>FABRIC/S section</li>
-                            <li>OTHER FABRIC/S section</li>
-                            <li>TRIM/S section</li>
-                        </ul>
-                    </div>
-                </div>
-                
-                <!-- Excel Library Status -->
-                <div id="excelStatus" style="background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); border-radius: 8px; padding: 15px; margin-top: 15px;">
-                    <h5 style="color: #ffc107; margin-bottom: 10px;">⚠️ Excel Library Status</h5>
-                    <p style="color: rgba(255, 255, 255, 0.9); font-size: 14px; margin: 0;">
-                        Excel library will load automatically when needed. If Excel files don't work, try converting to CSV format.
-                    </p>
-                </div>
-            </div>
-            
-            <!-- Import Options -->
-            <div class="import-options" style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 20px; margin: 20px 0; border: 1px solid rgba(255, 255, 255, 0.2);">
-                <h4 style="color: white; margin-bottom: 15px;">⚙️ Import Settings</h4>
-                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
-                    <label style="display: flex; align-items: center; color: white; cursor: pointer;">
-                        <input type="checkbox" id="skipDuplicates" checked style="margin-right: 10px; transform: scale(1.2);">
-                        Skip duplicate entries
-                    </label>
-                    <label style="display: flex; align-items: center; color: white; cursor: pointer;">
-                        <input type="checkbox" id="validateData" checked style="margin-right: 10px; transform: scale(1.2);">
-                        Validate data before import
-                    </label>
-                    <label style="display: flex; align-items: center; color: white; cursor: pointer;">
-                        <input type="checkbox" id="autoCalculate" checked style="margin-right: 10px; transform: scale(1.2);">
-                        Auto-calculate missing values
-                    </label>
-                    <label style="display: flex; align-items: center; color: white; cursor: pointer;">
-                        <input type="checkbox" id="showValidationPage" checked style="margin-right: 10px; transform: scale(1.2);">
-                        Show validation page for errors
-                    </label>
-                </div>
-            </div>
-            
-            <!-- Progress Indicator -->
-            <div id="importProgress" class="import-progress" style="display: none; background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 20px; margin: 20px 0; border: 1px solid rgba(255, 255, 255, 0.2);">
-                <h4 style="color: white; margin-bottom: 15px;">🔄 Processing File...</h4>
-                <div class="progress-bar" style="background: rgba(0, 0, 0, 0.3); border-radius: 10px; height: 20px; overflow: hidden; margin-bottom: 10px;">
-                    <div class="progress-fill" id="progressFill" style="background: linear-gradient(90deg, #4CAF50, #2196F3); height: 100%; width: 0%; transition: width 0.3s ease;"></div>
-                </div>
-                <p id="progressText" style="color: rgba(255, 255, 255, 0.9); margin: 0; text-align: center;">Analyzing file structure...</p>
-            </div>
-            
-            <!-- Data Review Panel -->
-            <div id="dataReviewPanel" style="display: none; margin-top: 20px;">
-                <div style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px; backdrop-filter: blur(10px);">
-                    <h3 style="color: white; margin-bottom: 15px;">🔍 Data Review & Verification</h3>
-                    <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 20px;">Please review the scanned data and verify column mappings before importing</p>
-                    
-                    <!-- Template Detection Result -->
-                    <div id="templateDetectionResult" style="background: rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 15px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                        <h4 style="color: #4CAF50; margin-bottom: 10px;">🎯 Template Detection</h4>
-                        <div id="templateInfo" style="color: rgba(255, 255, 255, 0.9);"></div>
-                    </div>
-                    
-                    <!-- Scanned Data Summary -->
-                    <div id="scannedDataSummary" style="background: rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 15px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                        <h4 style="color: #2196F3; margin-bottom: 10px;">📋 Scanned Data Summary</h4>
-                        <div id="summaryContent" style="color: rgba(255, 255, 255, 0.9);"></div>
-                    </div>
-                    
-                    <!-- Column Mapping Review -->
-                    <div id="columnMappingReview" style="background: rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 15px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                        <h4 style="color: #FF9800; margin-bottom: 10px;">🗂️ Column Mapping Review</h4>
-                        <div id="mappingContent" style="color: rgba(255, 255, 255, 0.9);"></div>
-                    </div>
-                    
-                    <!-- Validation Results -->
-                    <div id="validationResults" style="background: rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 15px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                        <h4 style="color: #F44336; margin-bottom: 10px;">⚠️ Validation Results</h4>
-                        <div id="validationContent" style="color: rgba(255, 255, 255, 0.9);"></div>
-                    </div>
-                    
-                    <!-- Action Buttons -->
-                    <div style="text-align: center; margin-top: 20px;">
-                        <button class="btn btn-secondary" onclick="cancelImport()" style="margin-right: 10px; background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">❌ Cancel</button>
-                        <button class="btn btn-primary" onclick="confirmImport()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">✅ Confirm & Import Data</button>
-                    </div>
-                </div>
-            </div>
-            
-            <div id="filePreview" style="display: none;">
-                <h3>File Preview</h3>
-                <div id="previewTable"></div>
-                <button onclick="importFile()">Import Data</button>
-            </div>
-            
-            <div id="importStatus"></div>
-            </div>
-        </div>
     </div>
 
-    <!-- Validation Page -->
-    <div id="validationPage" class="validation-page" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 10000; overflow-y: auto;">
-        <div class="validation-container" style="max-width: 1200px; margin: 20px auto; background: rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 30px; backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2);">
-            <div class="validation-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
-                <h2 style="color: white; margin: 0;">🔧 Data Validation & Correction</h2>
-                <button onclick="closeValidationPage()" style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">✕ Close</button>
-            </div>
-            
-            <div class="validation-content">
-                <div id="validationSummary" style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                    <h3 style="color: #FF9800; margin-bottom: 15px;">📊 Validation Summary</h3>
-                    <div id="validationSummaryContent" style="color: rgba(255, 255, 255, 0.9);"></div>
-                </div>
-                
-                <div id="errorList" style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                    <h3 style="color: #F44336; margin-bottom: 15px;">⚠️ Errors Found</h3>
-                    <div id="errorListContent" style="color: rgba(255, 255, 255, 0.9);"></div>
-                </div>
-                
-                <div id="editableData" style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
-                    <h3 style="color: #4CAF50; margin-bottom: 15px;">✏️ Edit Data</h3>
-                    <div id="editableDataContent" style="color: rgba(255, 255, 255, 0.9);"></div>
-                </div>
-                
-                <div class="validation-actions" style="text-align: center; margin-top: 30px;">
-                    <button onclick="saveValidationChanges()" class="btn btn-primary" style="background: #28a745; color: white; border: none; padding: 12px 30px; border-radius: 6px; cursor: pointer; font-size: 16px; margin-right: 15px;">💾 Save Changes</button>
-                    <button onclick="skipValidation()" class="btn btn-secondary" style="background: #6c757d; color: white; border: none; padding: 12px 30px; border-radius: 6px; cursor: pointer; font-size: 16px;">⏭️ Skip Validation</button>
-                </div>
-            </div>
-        </div>
-    </div>
 
     <script>
         // Enhanced and more reliable XLSX library loading
@@ -1378,18 +1069,8 @@
         });
 
         let connectionId = null;
-        let currentFile = null;
-        let filePreview = null;
-        let scannedData = null;
-        let columnMappings = null;
         let totalRecords = 0;
         
-        // Enhanced import system variables
-        let templateType = null;
-        let validationErrors = [];
-        let existingData = [];
-        let isProcessing = false;
-        
         // Pagination variables
         let currentPage = 1;
         let recordsPerPage = 20;
@@ -1412,39 +1093,7 @@
             }
         }
 
-        // Modal functions
-        function openImportModal() {
-            const modal = document.getElementById('importModal');
-            modal.style.display = 'flex';
-            document.body.style.overflow = 'hidden'; // Prevent background scrolling
-        }
-
-        function closeImportModal() {
-            const modal = document.getElementById('importModal');
-            modal.style.display = 'none';
-            document.body.style.overflow = 'auto'; // Restore scrolling
-            
-            // Reset import form
-            document.getElementById('fileInput').value = '';
-            document.getElementById('dataReviewPanel').style.display = 'none';
-            document.getElementById('filePreview').style.display = 'none';
-            document.getElementById('importStatus').innerHTML = '';
-        }
-
-        // Close modal when clicking outside
-        document.addEventListener('click', function(event) {
-            const modal = document.getElementById('importModal');
-            if (event.target === modal) {
-                closeImportModal();
-            }
-        });
 
-        // Close modal with Escape key
-        document.addEventListener('keydown', function(event) {
-            if (event.key === 'Escape') {
-                closeImportModal();
-            }
-        });
 
         // Pagination functions
         function updatePagination() {
@@ -1563,6 +1212,8 @@
             const pageData = dataToShow.slice(startIndex, endIndex);
             
             console.log('displayCurrentPageData - currentPage:', currentPage, 'startIndex:', startIndex, 'endIndex:', endIndex);
+            console.log('filteredData:', filteredData ? filteredData.length : 'null');
+            console.log('allTableData:', allTableData ? allTableData.length : 'null');
             console.log('dataToShow.length:', dataToShow.length, 'pageData.length:', pageData.length);
             console.log('pageData sample:', pageData.slice(0, 2));
             
@@ -1776,7 +1427,6 @@
         function displayTables(tables) {
             const tablesList = document.getElementById('tablesList');
             const selectedTable = document.getElementById('selectedTable');
-            const importTable = document.getElementById('importTable');
             
             let html = '<h3>Available Tables:</h3><ul>';
             tables.forEach(table => {
@@ -2553,9 +2203,12 @@
                 
                 if (result.data && result.data.length > 0) {
                     console.log(`Fresh data loaded: ${result.data.length} records`);
+                    console.log('Available database fields:', Object.keys(result.data[0] || {}));
+                    console.log('Sample record:', result.data[0]);
                     
-                    // Store the fresh data
+                    // Store the fresh data in both variables
                     window.currentTableData = result.data;
+                    allTableData = result.data; // Update allTableData with fresh data
                     
                     // Show searching animation
                     showSearchingAnimation(`Searching through ${result.data.length} FRESH records for ${filterType}: "${searchValue}"...`);
@@ -2563,9 +2216,29 @@
                     // Add a small delay to show the searching animation
                     await new Promise(resolve => setTimeout(resolve, 800));
                     
-                    // Filter the data on the client side
-                    const filteredData = result.data.filter(row => {
-                        const fieldValue = String(row[filterType] || '').toLowerCase();
+                    // Map filter type to actual database field name
+                    const fieldMapping = {
+                        'season': ['season', 'Season', 'SEASON', 'seasons', 'SEASONS'],
+                        'customer': ['customer', 'Customer', 'CUSTOMER', 'customers', 'CUSTOMERS'],
+                        'style_number': ['style_number', 'styleNumber', 'Style Number', 'STYLE_NUMBER', 'style_no', 'styleNo', 'STYLE_NO'],
+                        'style_name': ['style_name', 'styleName', 'Style Name', 'STYLE_NAME', 'style', 'STYLE']
+                    };
+                    
+                    // Find the actual database field name
+                    const possibleFieldNames = fieldMapping[filterType] || [filterType];
+                    const actualFieldName = possibleFieldNames.find(name => result.data[0] && result.data[0].hasOwnProperty(name));
+                    
+                    if (!actualFieldName) {
+                        console.error('Field not found in database:', filterType, 'Available fields:', Object.keys(result.data[0] || {}));
+                        showStatus('tableData', `❌ Field "${filterType}" not found in database. Available fields: ${Object.keys(result.data[0] || {}).join(', ')}`, 'error');
+                        return;
+                    }
+                    
+                    console.log(`Searching in field: ${actualFieldName} (mapped from ${filterType})`);
+                    
+                    // Filter the data on the client side and store in global filteredData
+                    filteredData = result.data.filter(row => {
+                        const fieldValue = String(row[actualFieldName] || '').toLowerCase();
                         const searchTerm = searchValue.toLowerCase();
                         return fieldValue.includes(searchTerm);
                     });
@@ -2757,16 +2430,6 @@
             return fileType;
         }
 
-        function resetImportState() {
-            isProcessing = false;
-            scannedData = null;
-            templateType = null;
-            columnMappings = null;
-            validationErrors = [];
-            existingData = [];
-            document.getElementById('dataReviewPanel').style.display = 'none';
-            document.getElementById('importProgress').style.display = 'none';
-        }
 
         function showFileInfo(file, fileType) {
             const fileInfo = `
@@ -2780,119 +2443,7 @@
             document.getElementById('importStatus').innerHTML = fileInfo;
         }
 
-        function handleFileSelect(event) {
-            const file = event.target.files[0];
-            if (!file) return;
 
-            // Reset previous state
-            resetImportState();
-            
-            try {
-                // Validate file
-                const fileType = validateFile(file);
-                currentFile = file;
-                
-                console.log('File selected:', {
-                    name: file.name,
-                    type: file.type,
-                    size: file.size,
-                    detectedType: fileType
-                });
-                
-                // Show file info
-                showFileInfo(file, fileType);
-                
-                // Start intelligent import process
-                processIntelligentImport(file, fileType);
-                
-            } catch (error) {
-                console.error('File validation failed:', error);
-                showStatus('importStatus', '❌ ' + error.message, 'error');
-                resetImportState();
-            }
-        }
-
-        // Enhanced Intelligent Import System - Main Processing Function
-        async function processIntelligentImport(file, fileType) {
-            if (isProcessing) {
-                console.warn('Import already in progress, ignoring new request');
-                return;
-            }
-
-            isProcessing = true;
-            
-            try {
-                console.log('Starting enhanced intelligent import for file:', file.name, 'Type:', fileType);
-                
-                // Show progress
-                showProgress(true);
-                updateProgress(5, 'Initializing...');
-                
-                // Read file content with enhanced error handling
-                updateProgress(10, `Reading ${fileType.toUpperCase()} file...`);
-                console.log('About to call readFileContent with fileType:', fileType);
-                const fileContent = await readFileContent(file, fileType);
-                console.log('File content loaded successfully, rows:', fileContent.length);
-                
-                // Validate file content
-                if (!fileContent || fileContent.length === 0) {
-                    throw new Error('File appears to be empty or invalid. Please check the file and try again.');
-                }
-                
-                updateProgress(25, 'Analyzing file structure...');
-                
-                // Detect template type with enhanced detection
-                templateType = detectTemplateType(fileContent);
-                console.log('Template detected:', templateType);
-                updateProgress(40, `Detected template: ${templateType.toUpperCase()}`);
-                
-                // Extract data based on template with better error handling
-                updateProgress(55, 'Extracting data...');
-                scannedData = await extractDataFromTemplate(fileContent, templateType);
-                console.log('Data extracted:', scannedData);
-                
-                // Check for duplicates with enhanced error handling
-                updateProgress(70, 'Checking for duplicates...');
-                if (document.getElementById('skipDuplicates').checked) {
-                    try {
-                        await checkDuplicates(scannedData);
-                        console.log('Duplicate check completed, existing records:', existingData ? existingData.length : 0);
-                    } catch (error) {
-                        console.warn('Duplicate check failed, continuing without duplicate checking:', error);
-                        existingData = [];
-                    }
-                } else {
-                    existingData = [];
-                }
-                
-                // Validate data with comprehensive validation
-                updateProgress(85, 'Validating data...');
-                if (document.getElementById('validateData').checked) {
-                    validationErrors = validateData(scannedData);
-                    console.log('Validation completed, errors:', validationErrors.length);
-                } else {
-                    validationErrors = [];
-                }
-                
-                // Map columns to database structure
-                updateProgress(95, 'Mapping columns...');
-                columnMappings = mapColumnsToDatabase(scannedData, templateType);
-                console.log('Column mappings created:', Object.keys(columnMappings).length);
-                
-                updateProgress(100, 'Complete!');
-                
-                // Show results with enhanced display
-                showDataReview();
-                
-            } catch (error) {
-                console.error('Error in enhanced intelligent import:', error);
-                showStatus('importStatus', '❌ Error processing file: ' + error.message, 'error');
-                resetImportState();
-            } finally {
-                isProcessing = false;
-                showProgress(false);
-            }
-        }
 
         // Optimized File Reading Functions
         async function readFileContent(file, fileType) {
@@ -3606,384 +3157,12 @@
             document.getElementById('filePreview').style.display = 'block';
         }
 
-        async function importFile() {
-            if (!currentFile || !filePreview || !connectionId) return;
-
-            const tableName = document.getElementById('importTable').value;
-            if (!tableName) {
-                showStatus('importStatus', 'Please select a target table', 'error');
-                return;
-            }
-
-            // Create column mappings (simplified - maps file columns to database columns with same name)
-            const mappings = filePreview.length > 0 ? 
-                Object.keys(filePreview[0]).map(col => ({
-                    fileColumn: col,
-                    databaseColumn: col,
-                    required: false
-                })) : [];
-
-            const config = {
-                table: tableName,
-                mappings: mappings,
-                skipFirstRow: true,
-                updateExisting: false,
-                batchSize: 100
-            };
-
-            const formData = new FormData();
-            formData.append('file', currentFile);
-            formData.append('config', JSON.stringify(config));
-
-            try {
-                const isCSV = currentFile.name.endsWith('.csv');
-                const endpoint = isCSV ? 'csv' : 'excel';
-                
-                const response = await fetch(`/api/import/${endpoint}/${connectionId}`, {
-                    method: 'POST',
-                    body: formData
-                });
-
-                const result = await response.json();
-                
-                if (result.success) {
-                    showStatus('importStatus', 
-                        `Import successful! Processed: ${result.rowsProcessed}, Inserted: ${result.rowsInserted}`, 
-                        'success');
-                } else {
-                    showStatus('importStatus', 'Import failed: ' + result.message, 'error');
-                }
-            } catch (error) {
-                showStatus('importStatus', 'Import error: ' + error.message, 'error');
-            }
-        }
 
         function showStatus(elementId, message, type) {
             const element = document.getElementById(elementId);
             element.innerHTML = `<div class="status ${type}">${message}</div>`;
         }
 
-        // Excel file scanning and data extraction
-        async function scanExcelFile(file) {
-            try {
-                console.log('Starting Excel file scan...');
-                
-                // Simulate Excel parsing (in real implementation, you'd use a library like SheetJS)
-                const mockScannedData = await simulateExcelScan(file);
-                
-                scannedData = mockScannedData;
-                columnMappings = generateColumnMappings(mockScannedData);
-                
-                // Show the review panel
-                showDataReviewPanel();
-                
-            } catch (error) {
-                console.error('Error scanning Excel file:', error);
-                showStatus('importStatus', '❌ Error scanning file: ' + error.message, 'error');
-            }
-        }
-
-        // Simulate Excel file scanning (replace with actual Excel parsing)
-        async function simulateExcelScan(file) {
-            // This would be replaced with actual Excel parsing using SheetJS or similar
-            return new Promise((resolve) => {
-                setTimeout(() => {
-                    const mockData = {
-                        customer: 'TNF',
-                        season: 'F27',
-                        styleNumber: 'TNFF27-014',
-                        styleName: 'Fuzzy Wool Blend Beanie',
-                        costedQuantity: '2000pcs',
-                        leadtime: '130 days',
-                        
-                        // Yarn section
-                        yarn: [
-                            { material: '(UJ-F19-011) 100% Nylon, 1/7.2 Nm', consumption: '50', price: '14.79', cost: '0.74' },
-                            { material: '(HYDD ECO) 65% RWS 21.5mic Merino Wool 35%', consumption: '66', price: '19.38', cost: '1.28' }
-                        ],
-                        
-                        // Fabric section
-                        fabric: [
-                            { material: 'Fabric 1', consumption: '0', price: '0.00', cost: '0.00' }
-                        ],
-                        
-                        // Trim section
-                        trim: [
-                            { material: 'Sewing Thread (Coats EcoV)', consumption: '1', price: '0.02', cost: '0.02' }
-                        ],
-                        
-                        // Knitting section
-                        knitting: [
-                            { operation: 'Flat-3GG', time: '8', rate: '0.100', cost: '0.80' }
-                        ],
-                        
-                        // Operations section
-                        operations: [
-                            { operation: 'Labeling', cost: '0.10' },
-                            { operation: 'Neaten/Steaming/Packing (Beanie)', cost: '0.40' },
-                            { operation: 'Linking Beanie (Flat/ 1 Layer/ Cuff)', cost: '0.17' },
-                            { operation: 'Washing (Hat/ Glove)', cost: '0.17' },
-                            { operation: 'Hand Closing (9-3GG)', cost: '0.12' }
-                        ],
-                        
-                        // Packaging section
-                        packaging: [
-                            { type: 'Standard Packaging', cost: '0.10' },
-                            { type: 'Special Packaging', cost: '0.00' }
-                        ],
-                        
-                        // Totals
-                        totals: {
-                            materialCost: '2.04',
-                            knittingCost: '0.80',
-                            operationsCost: '0.96',
-                            packagingCost: '0.10',
-                            overhead: '0.20',
-                            profit: '0.59',
-                            totalFactoryCost: '4.69'
-                        }
-                    };
-                    resolve(mockData);
-                }, 2000); // Simulate processing time
-            });
-        }
-
-        // Generate column mappings for the scanned data
-        function generateColumnMappings(data) {
-            const mappings = {
-                'Season': data.season || '',
-                'Customer': data.customer || '',
-                'Style Number': data.styleNumber || '',
-                'Style Name': data.styleName || '',
-                'Main Material': data.yarn && data.yarn[0] ? data.yarn[0].material : '',
-                'Material Consumption': data.yarn && data.yarn[0] ? data.yarn[0].consumption : '',
-                'Material Price': data.yarn && data.yarn[0] ? data.yarn[0].price : '',
-                'Trim Cost': data.totals ? data.totals.materialCost : '',
-                'Total Material Cost': data.totals ? data.totals.materialCost : '',
-                'Knitting Machine': data.knitting && data.knitting[0] ? data.knitting[0].operation : '',
-                'Knitting Time': data.knitting && data.knitting[0] ? data.knitting[0].time : '',
-                'Knitting CPM': data.knitting && data.knitting[0] ? data.knitting[0].rate : '',
-                'Knitting Cost': data.knitting && data.knitting[0] ? data.knitting[0].cost : '',
-                'Ops Cost': data.totals ? data.totals.operationsCost : '',
-                'Knitting + Ops Cost': data.totals ? (parseFloat(data.totals.knittingCost || 0) + parseFloat(data.totals.operationsCost || 0)).toFixed(2) : '',
-                'Packaging': data.totals ? data.totals.packagingCost : '',
-                'OH': data.totals ? data.totals.overhead : '',
-                'Profit': data.totals ? data.totals.profit : '',
-                'FTY Adjustment': '0.00',
-                'TTL FTY Cost': data.totals ? data.totals.totalFactoryCost : ''
-            };
-            
-            return mappings;
-        }
-
-        // Show the data review panel
-        function showDataReviewPanel() {
-            document.getElementById('dataReviewPanel').style.display = 'block';
-            
-            // Populate scanned data summary
-            const summaryContent = document.getElementById('summaryContent');
-            summaryContent.innerHTML = `
-                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
-                    <div>
-                        <strong>Customer:</strong> ${scannedData.customer}<br>
-                        <strong>Season:</strong> ${scannedData.season}<br>
-                        <strong>Style #:</strong> ${scannedData.styleNumber}
-                    </div>
-                    <div>
-                        <strong>Style Name:</strong> ${scannedData.styleName}<br>
-                        <strong>Quantity:</strong> ${scannedData.costedQuantity}<br>
-                        <strong>Leadtime:</strong> ${scannedData.leadtime}
-                    </div>
-                </div>
-                <div style="background: #e8f5e8; padding: 10px; border-radius: 4px;">
-                    <strong>Total Factory Cost:</strong> $${scannedData.totals.totalFactoryCost}
-                </div>
-            `;
-            
-            // Populate column mapping review
-            const mappingContent = document.getElementById('mappingContent');
-            let mappingHtml = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">';
-            
-            Object.entries(columnMappings).forEach(([column, value]) => {
-                mappingHtml += `
-                    <div style="display: flex; justify-content: space-between; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
-                        <span><strong>${column}:</strong></span>
-                        <span style="color: #007bff;">${value || '—'}</span>
-                    </div>
-                `;
-            });
-            
-            mappingHtml += '</div>';
-            mappingContent.innerHTML = mappingHtml;
-            
-            showStatus('importStatus', '✅ Excel file scanned successfully! Please review the data below.', 'success');
-        }
-
-        // Validation Page Functions
-        function closeValidationPage() {
-            document.getElementById('validationPage').style.display = 'none';
-        }
-
-        function saveValidationChanges() {
-            // Get edited values from the validation page
-            const editedData = getEditedDataFromValidationPage();
-            
-            // Update the scanned data with edited values
-            Object.assign(scannedData, editedData);
-            
-            // Re-validate the data
-            validationErrors = validateData(scannedData);
-            
-            // Re-map columns
-            columnMappings = mapColumnsToDatabase(scannedData, templateType);
-            
-            // Close validation page and show updated review
-            closeValidationPage();
-            showDataReview();
-        }
-
-        function skipValidation() {
-            closeValidationPage();
-            showDataReview();
-        }
-
-        function getEditedDataFromValidationPage() {
-            // Extract edited values from the validation page form
-            const editedData = {};
-            
-            Object.keys(columnMappings).forEach(key => {
-                const inputId = `edit_${key.replace(/\s+/g, '_')}`;
-                const inputElement = document.getElementById(inputId);
-                if (inputElement) {
-                    const value = inputElement.value.trim();
-                    
-                    // Convert to appropriate data type
-                    if (key.includes('Consumption') || key.includes('Price') || key.includes('Cost') || 
-                        key.includes('Time') || key.includes('CPM') || key.includes('Adjustment')) {
-                        editedData[key.toLowerCase().replace(/\s+/g, '')] = parseFloat(value) || 0;
-                    } else {
-                        editedData[key.toLowerCase().replace(/\s+/g, '')] = value;
-                    }
-                }
-            });
-            
-            return editedData;
-        }
-
-        // Enhanced Import Functions
-        function cancelImport() {
-            resetImportState();
-            document.getElementById('fileInput').value = '';
-            currentFile = null;
-            showStatus('importStatus', 'Import cancelled', 'info');
-        }
-
-        async function confirmImport() {
-            try {
-                // Check if validation errors exist and show validation page if needed
-                if (validationErrors.length > 0 && document.getElementById('showValidationPage').checked) {
-                    showValidationPage();
-                    return;
-                }
-
-                showStatus('importStatus', '🔄 Importing data to database...', 'info');
-                
-                // Convert mappings to database format
-                const dbRecord = {
-                    season: columnMappings['Season'],
-                    customer: columnMappings['Customer'],
-                    style_number: columnMappings['Style Number'],
-                    style_name: columnMappings['Style Name'],
-                    main_material: columnMappings['Main Material'],
-                    material_consumption: columnMappings['Material Consumption'],
-                    material_price: columnMappings['Material Price'],
-                    trim_cost: columnMappings['Trim Cost'],
-                    total_material_cost: columnMappings['Total Material Cost'],
-                    knitting_machine: columnMappings['Knitting Machine'],
-                    knitting_time: columnMappings['Knitting Time'],
-                    knitting_cpm: columnMappings['Knitting CPM'],
-                    knitting_cost: columnMappings['Knitting Cost'],
-                    ops_cost: columnMappings['Ops Cost'],
-                    knitting_ops_cost: columnMappings['Knitting + Ops Cost'],
-                    packaging: columnMappings['Packaging'],
-                    oh: columnMappings['OH'],
-                    profit: columnMappings['Profit'],
-                    fty_adjustment: columnMappings['FTY Adjustment'],
-                    ttl_fty_cost: columnMappings['TTL FTY Cost']
-                };
-                
-                console.log('Importing record to Supabase:', dbRecord);
-                
-                // Send data to backend API
-                const response = await fetch(`/api/datatable/insert/${connectionId}`, {
-                    method: 'POST',
-                    headers: { 'Content-Type': 'application/json' },
-                    body: JSON.stringify({
-                        table: 'databank',
-                        data: dbRecord
-                    })
-                });
-                
-                const result = await response.json();
-                console.log('Insert result:', result);
-                
-                if (result.success) {
-                    showStatus('importStatus', '✅ Data imported successfully! Refreshing table...', 'success');
-                    
-                    // Hide review panel and refresh table
-                    document.getElementById('dataReviewPanel').style.display = 'none';
-                    document.getElementById('fileInput').value = '';
-                    
-                    // Refresh the main table
-                    setTimeout(() => {
-                        loadDatabankData();
-                        getTotalRecordCount();
-                    }, 1000);
-                } else {
-                    throw new Error(result.error || result.message || 'Failed to insert data');
-                }
-                
-            } catch (error) {
-                console.error('Error importing data:', error);
-                showStatus('importStatus', '❌ Error importing data: ' + error.message, 'error');
-            }
-        }
-
-        function showValidationPage() {
-            // Populate validation page with current data and errors
-            document.getElementById('validationSummaryContent').innerHTML = `
-                <p><strong>Template:</strong> ${templateType.toUpperCase()}</p>
-                <p><strong>Total Errors:</strong> ${validationErrors.length}</p>
-                <p><strong>Fields with Issues:</strong> ${validationErrors.map(e => e.field).join(', ')}</p>
-            `;
-            
-            let errorHtml = '<ul>';
-            validationErrors.forEach(error => {
-                errorHtml += `<li style="margin-bottom: 10px; padding: 10px; background: rgba(255, 0, 0, 0.1); border-radius: 6px;">
-                    <strong>${error.field}:</strong> ${error.message}
-                </li>`;
-            });
-            errorHtml += '</ul>';
-            document.getElementById('errorListContent').innerHTML = errorHtml;
-            
-            // Create editable form for the data
-            let editableHtml = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">';
-            Object.entries(columnMappings).forEach(([key, value]) => {
-                const hasError = validationErrors.some(e => e.field === key.toLowerCase().replace(/\s+/g, ''));
-                editableHtml += `
-                    <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 8px; ${hasError ? 'border: 2px solid #ff6b6b;' : ''}">
-                        <label style="display: block; margin-bottom: 5px; color: white; font-weight: bold;">${key}:</label>
-                        <input type="text" id="edit_${key.replace(/\s+/g, '_')}" value="${value || ''}" 
-                               style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid rgba(255, 255, 255, 0.3); background: rgba(255, 255, 255, 0.1); color: white;">
-                    </div>
-                `;
-            });
-            editableHtml += '</div>';
-            document.getElementById('editableDataContent').innerHTML = editableHtml;
-            
-            // Show validation page
-            document.getElementById('validationPage').style.display = 'block';
-        }
     </script>
 </body>
 </html>
diff --git a/src/routes/import.ts b/src/routes/import.ts
index 510e5b6..8bc3b42 100644
--- a/src/routes/import.ts
+++ b/src/routes/import.ts
@@ -16,17 +16,14 @@ const upload = multer({
   },
   fileFilter: (req, file, cb) => {
     const allowedTypes = [
-      'text/csv',
-      'application/vnd.ms-excel',
-      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
+      'text/csv'
     ];
     
     if (allowedTypes.includes(file.mimetype) || 
-        file.originalname.endsWith('.csv') || 
-        file.originalname.endsWith('.xlsx')) {
+        file.originalname.endsWith('.csv')) {
       cb(null, true);
     } else {
-      cb(new Error('Invalid file type. Only CSV and Excel files are allowed.'));
+      cb(new Error('Invalid file type. Only CSV files are allowed.'));
     }
   }
 });
@@ -87,33 +84,6 @@ router.post('/csv/:connectionId', upload.single('file'), async (req: Request, re
   }
 });
 
-router.post('/excel/:connectionId', upload.single('file'), async (req: Request, res: Response) => {
-  try {
-    const { connectionId } = req.params;
-    const config: ImportConfig = JSON.parse(req.body.config);
-    const { sheetName } = req.body;
-
-    if (!req.file) {
-      return res.status(400).json({ error: 'No file uploaded' });
-    }
-
-    const connection = getConnection(connectionId);
-    if (!connection) {
-      return res.status(404).json({ error: 'Connection not found' });
-    }
-
-    const importService = new ImportService(connection);
-    const result = await importService.importExcel(req.file, config, sheetName);
-
-    return res.json(result);
-  } catch (error) {
-    logger.error('Error importing Excel:', error);
-    return res.status(500).json({ 
-      error: 'Failed to import Excel',
-      message: error instanceof Error ? error.message : 'Unknown error'
-    });
-  }
-});
 
 router.post('/bulk-insert/:connectionId', async (req: Request, res: Response) => {
   try {
diff --git a/src/services/importService.ts b/src/services/importService.ts
index 3a83f33..3a5aa22 100644
--- a/src/services/importService.ts
+++ b/src/services/importService.ts
@@ -1,4 +1,3 @@
-import * as XLSX from 'xlsx';
 import csv from 'csv-parser';
 import { Readable } from 'stream';
 import { DatabaseConnection } from '../config/database';
@@ -28,21 +27,6 @@ export class ImportService {
     }
   }
 
-  async importExcel(file: FileUpload, config: ImportConfig, sheetName?: string): Promise<ImportResult> {
-    try {
-      const data = await this.parseExcel(file.buffer, sheetName);
-      return await this.processData(data, config);
-    } catch (error) {
-      logger.error('Excel import error:', error);
-      return {
-        success: false,
-        message: `Excel import failed: ${error}`,
-        rowsProcessed: 0,
-        rowsInserted: 0,
-        errors: [error instanceof Error ? error.message : String(error)]
-      };
-    }
-  }
 
   private async parseCSV(buffer: Buffer): Promise<any[]> {
     return new Promise((resolve, reject) => {
@@ -57,16 +41,6 @@ export class ImportService {
     });
   }
 
-  private async parseExcel(buffer: Buffer, sheetName?: string): Promise<any[]> {
-    const workbook = XLSX.read(buffer, { type: 'buffer' });
-    const sheet = sheetName ? workbook.Sheets[sheetName] : workbook.Sheets[workbook.SheetNames[0]];
-    
-    if (!sheet) {
-      throw new Error(`Sheet "${sheetName || workbook.SheetNames[0]}" not found`);
-    }
-
-    return XLSX.utils.sheet_to_json(sheet);
-  }
 
   private async processData(data: any[], config: ImportConfig): Promise<ImportResult> {
     const errors: string[] = [];
@@ -237,8 +211,6 @@ export class ImportService {
       
       if (file.mimetype === 'text/csv' || file.originalname.endsWith('.csv')) {
         data = await this.parseCSV(file.buffer);
-      } else if (file.mimetype.includes('spreadsheet') || file.originalname.endsWith('.xlsx')) {
-        data = await this.parseExcel(file.buffer);
       } else {
         throw new Error('Unsupported file type');
       }
-- 
2.51.0.windows.1

